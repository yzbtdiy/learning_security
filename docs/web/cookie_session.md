## 会话技术

由于HTTP是无状态协议，所以HTTP协议无法记住客户端信息。Web应用为执行各种有用的功能，应用程序需要追踪每名用户通过不同的请求与应用程序交互的状态。例如，一个购物应用程序允许用户浏览产品目录、往购物车内添加商品、查看并更新购物车内容、结账并提供个人与支付信息。

为实现这种功能，服务端生成一组在用户提交各种请求过程中代表状态的数据，这些数据通常保存在一个叫会话的服务端结构中。会话包含了cookie和session。

### Session

由于HTTP协议无状态，服务端无法法识别哪个用户操作的，所以服务端要为特定的用户创建特定的Session，用于标识这个用户，并跟踪用户，这样才知道该用户的购物车里面有几本书。Session是存在服务端的，是唯一标识。

### Cookie

服务端通过Cookie识别特定的客户，每次HTTP请求时，客户端都会发送相应的Cookie信息到服务端。实际上大多数的应用都是用Cookie来实现Session跟踪的，第一次创建Session的时候，服务端会在HTTP协议中告诉客户端，需要在Cookie里面记录一个Session ID，以后每次请求把这个会话ID发送到服务器，服务器即可识别。


### 登录流程

WEB应用判断用户是否登录

1. 当用户提交的帐号密码正确后，服务端会使用SESSION将用户信息存储到服务端。并将 SESSIONID 以 SETCOOKIE 的形式返回给客户端。

2. 当用户第二次访问站点时，会自动带上COOKIE信息，那么服务端会根据COOKIE中的SESSIONID进行匹配数据。

* 如果存在数据，则说明已经登录过，为登录状态。
* 如果不存在数据，则说明没有登录，为未登录状态。

![cookie_session.svg](https://cdn.jsdelivr.net/gh/yzbtdiy/cdn@security/imgs/http/cookie_session.svg)